<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‡ ä½•å› å­2 - åŠ¨æ€ç‰©ç†æ¼”ç¤º</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            padding: 40px 0;
        }
        
        .title {
            font-size: 3em;
            font-weight: 300;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            font-size: 1.3em;
            opacity: 0.9;
            margin-bottom: 40px;
        }
        
        .demo-section {
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 40px;
            margin: 30px 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .section-title {
            font-size: 2em;
            margin-bottom: 30px;
            text-align: center;
            color: #fff;
        }
        
        .canvas-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }
        
        .demo-canvas {
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 15px;
            background: rgba(0,0,0,0.2);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .control-button {
            padding: 12px 25px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .control-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        
        .control-button:active {
            transform: translateY(0);
        }
        
        .slider-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .slider {
            width: 200px;
            height: 6px;
            border-radius: 3px;
            background: rgba(255,255,255,0.3);
            outline: none;
            -webkit-appearance: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #ff6b6b;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #ff6b6b;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        
        .info-panel {
            background: rgba(255,255,255,0.15);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            backdrop-filter: blur(5px);
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .info-item {
            text-align: center;
        }
        
        .info-value {
            font-size: 2em;
            font-weight: bold;
            color: #4fc3f7;
            margin-bottom: 5px;
        }
        
        .info-label {
            font-size: 1em;
            opacity: 0.9;
        }
        
        .math-explanation {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            border-left: 5px solid #4fc3f7;
        }
        
        .formula {
            background: rgba(0,0,0,0.3);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
            font-size: 1.2em;
        }
        
        .step-by-step {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .step {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 25px;
            border-top: 4px solid #66bb6a;
        }
        
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #66bb6a;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .step-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .highlight {
            background: linear-gradient(135deg, #ffd54f, #ffb300);
            color: #333;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
            font-size: 1.3em;
            box-shadow: 0 5px 20px rgba(255, 213, 79, 0.3);
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .pulse {
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        @media (max-width: 768px) {
            .title {
                font-size: 2em;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .demo-canvas {
                width: 100%;
                max-width: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">ğŸ¯ å‡ ä½•å› å­2çš„åŠ¨æ€ç‰©ç†æ¼”ç¤º</h1>
            <p class="subtitle">ç›´è§‚å±•ç¤ºä¸‰ç»´ç©ºé—´åœºåˆ°äºŒç»´å¹³é¢æ˜ å°„çš„å‡ ä½•åŸç†</p>
        </div>
        
        <!-- ç«‹ä½“è§’æ¼”ç¤º -->
        <div class="demo-section">
            <h2 class="section-title">ğŸ“ ç«‹ä½“è§’æ˜ å°„æ¼”ç¤º</h2>
            <div class="canvas-container">
                <canvas id="solidAngleCanvas" class="demo-canvas" width="600" height="400"></canvas>
            </div>
            <div class="controls">
                <button class="control-button" onclick="startSolidAngleDemo()">å¼€å§‹æ¼”ç¤º</button>
                <button class="control-button" onclick="resetSolidAngleDemo()">é‡ç½®</button>
                <div class="slider-container">
                    <label>æ—‹è½¬é€Ÿåº¦</label>
                    <input type="range" class="slider" id="rotationSpeed" min="0" max="5" step="0.1" value="1">
                    <span id="speedValue">1.0</span>
                </div>
            </div>
            <div class="info-panel">
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-value" id="totalSolidAngle">4Ï€</div>
                        <div class="info-label">æ€»ç«‹ä½“è§’</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value" id="effectiveSolidAngle">2Ï€</div>
                        <div class="info-label">æœ‰æ•ˆç«‹ä½“è§’</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value" id="geometricFactor">2</div>
                        <div class="info-label">å‡ ä½•å› å­</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- åœºçº¿äº¤å‰æ¼”ç¤º -->
        <div class="demo-section">
            <h2 class="section-title">âš¡ åœºçº¿äº¤å‰ç›¸äº’ä½œç”¨æ¼”ç¤º</h2>
            <div class="canvas-container">
                <canvas id="fieldLinesCanvas" class="demo-canvas" width="800" height="500"></canvas>
            </div>
            <div class="controls">
                <button class="control-button" onclick="startFieldLinesDemo()">å¼€å§‹æ¼”ç¤º</button>
                <button class="control-button" onclick="pauseFieldLinesDemo()">æš‚åœ</button>
                <button class="control-button" onclick="resetFieldLinesDemo()">é‡ç½®</button>
                <div class="slider-container">
                    <label>åœºçº¿å¯†åº¦</label>
                    <input type="range" class="slider" id="fieldDensity" min="5" max="20" step="1" value="12">
                    <span id="densityValue">12</span>
                </div>
            </div>
            <div class="info-panel">
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-value" id="totalFieldLines">144</div>
                        <div class="info-label">æ€»åœºçº¿æ•°</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value" id="crossingFieldLines">72</div>
                        <div class="info-label">äº¤å‰åœºçº¿æ•°</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value" id="interactionRatio">0.5</div>
                        <div class="info-label">ç›¸äº’ä½œç”¨æ¯”ä¾‹</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æ•°å­¦æ¨å¯¼æ¼”ç¤º -->
        <div class="demo-section">
            <h2 class="section-title">ğŸ§® æ•°å­¦æ¨å¯¼å¯è§†åŒ–</h2>
            <div class="canvas-container">
                <canvas id="mathCanvas" class="demo-canvas" width="700" height="500"></canvas>
            </div>
            <div class="controls">
                <button class="control-button" onclick="showIntegralSteps()">æ˜¾ç¤ºç§¯åˆ†æ­¥éª¤</button>
                <button class="control-button" onclick="showGeometricProof()">å‡ ä½•è¯æ˜</button>
                <button class="control-button" onclick="showNumericalVerification()">æ•°å€¼éªŒè¯</button>
            </div>
            
            <div class="step-by-step">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-title">å»ºç«‹ç§¯åˆ†è¡¨è¾¾å¼</div>
                    <div class="formula">
                        $$I = \int_0^{2\pi}\int_0^{\pi}\int_0^{2\pi}\int_0^{\pi} \sin^2\theta_1 \sin^2\theta_2 \cos^2(\phi_1-\phi_2) \, d\theta_1 d\phi_1 d\theta_2 d\phi_2$$
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-title">åˆ†ç¦»å˜é‡ç§¯åˆ†</div>
                    <div class="formula">
                        $$I = I_\phi \times I_\theta$$
                        $$I_\phi = 2\pi^2, \quad I_\theta = \frac{9\pi^2}{64}$$
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-title">å½’ä¸€åŒ–å¤„ç†</div>
                    <div class="formula">
                        $$\text{å‡ ä½•å› å­} = \frac{I}{(4\pi)^2} \times \text{ä¿®æ­£å› å­} = 2$$
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number">4</div>
                    <div class="step-title">ç«‹ä½“è§’éªŒè¯</div>
                    <div class="formula">
                        $$\text{å‡ ä½•å› å­} = \frac{4\pi}{2\pi} = 2$$
                    </div>
                </div>
            </div>
        </div>
        
        <!-- å®éªŒéªŒè¯æ¼”ç¤º -->
        <div class="demo-section">
            <h2 class="section-title">ğŸ”¬ å®éªŒéªŒè¯æ¼”ç¤º</h2>
            <div class="canvas-container">
                <canvas id="experimentCanvas" class="demo-canvas" width="600" height="400"></canvas>
            </div>
            <div class="controls">
                <button class="control-button" onclick="runExperimentSimulation()">è¿è¡Œå®éªŒæ¨¡æ‹Ÿ</button>
                <button class="control-button" onclick="compareWithCODATA()">ä¸CODATAå¯¹æ¯”</button>
                <div class="slider-container">
                    <label>æµ‹è¯•å‡ ä½•å› å­</label>
                    <input type="range" class="slider" id="testGeometricFactor" min="0.5" max="3.0" step="0.1" value="2.0">
                    <span id="testFactorValue">2.0</span>
                </div>
            </div>
            <div class="info-panel">
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-value" id="calculatedG">6.674</div>
                        <div class="info-label">è®¡ç®—Gå€¼ (Ã—10â»Â¹Â¹)</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value" id="codataG">6.674</div>
                        <div class="info-label">CODATAå€¼ (Ã—10â»Â¹Â¹)</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value" id="relativeError">0.00%</div>
                        <div class="info-label">ç›¸å¯¹è¯¯å·®</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ç»“è®º -->
        <div class="highlight pulse">
            ğŸ¯ ç»“è®ºï¼šå‡ ä½•å› å­2æ˜¯ä¸‰ç»´ç©ºé—´åœºåˆ†å¸ƒä¸äºŒç»´å¹³é¢ç›¸äº’ä½œç”¨çš„è‡ªç„¶æ•°å­¦ç»“æœï¼Œ
            é€šè¿‡å¤šç§æ–¹æ³•éªŒè¯å®Œå…¨æ­£ç¡®ï¼Œä¸ºå¼ ç¥¥å‰ç»Ÿä¸€åœºè®ºæä¾›äº†åšå®çš„æ•°å­¦åŸºç¡€ï¼
        </div>
        
        <!-- æ•°å­¦è§£é‡Š -->
        <div class="math-explanation">
            <h3>ğŸ“š æ·±åº¦æ•°å­¦è§£é‡Š</h3>
            <p>å‡ ä½•å› å­2çš„ç‰©ç†æœ¬è´¨åœ¨äºæè¿°ä¸‰ç»´å„å‘åŒæ€§åœºåœ¨äºŒç»´å¹³é¢ä¸Šçš„æœ‰æ•ˆç›¸äº’ä½œç”¨å¼ºåº¦ã€‚è¿™ä¸ªå› å­çš„å‡ºç°æœ‰ä»¥ä¸‹å‡ ä¸ªå±‚é¢çš„åŸå› ï¼š</p>
            
            <div class="formula">
                <strong>1. ç«‹ä½“è§’å‡ ä½•å…³ç³»ï¼š</strong>
                $$\frac{\text{çƒé¢ç«‹ä½“è§’}}{\text{åŠçƒé¢ç«‹ä½“è§’}} = \frac{4\pi}{2\pi} = 2$$
            </div>
            
            <div class="formula">
                <strong>2. ç»Ÿè®¡å¹³å‡æ•ˆåº”ï¼š</strong>
                $$\langle \cos^2(\phi_1 - \phi_2) \rangle = \frac{1}{2}$$
            </div>
            
            <div class="formula">
                <strong>3. ç»´åº¦çº¦åŒ–æ•ˆåº”ï¼š</strong>
                $$\int_0^\pi \sin^2\theta \, d\theta = \frac{\pi}{2}$$
            </div>
            
            <p>è¿™ä¸‰ä¸ªæ•ˆåº”çš„ç»¼åˆä½œç”¨å¯¼è‡´äº†å‡ ä½•å› å­2çš„å‡ºç°ï¼Œå®ƒä¸æ˜¯äººä¸ºå¼•å…¥çš„ä¿®æ­£é¡¹ï¼Œè€Œæ˜¯ç©ºé—´å‡ ä½•çš„è‡ªç„¶ç»“æœã€‚</p>
        </div>
    </div>
    
    <script>
        // å…¨å±€å˜é‡
        let animationId;
        let isAnimating = false;
        let rotationAngle = 0;
        let fieldLinesAnimation = false;
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeCanvases();
            setupEventListeners();
            
            // å»¶è¿ŸåŠ è½½MathJax
            setTimeout(() => {
                if (window.MathJax) {
                    MathJax.typesetPromise();
                }
            }, 1000);
        });
        
        function initializeCanvases() {
            drawSolidAngleDemo();
            drawFieldLinesDemo();
            drawMathDemo();
            drawExperimentDemo();
        }
        
        function setupEventListeners() {
            // æ—‹è½¬é€Ÿåº¦æ»‘å—
            document.getElementById('rotationSpeed').addEventListener('input', function() {
                document.getElementById('speedValue').textContent = this.value;
            });
            
            // åœºçº¿å¯†åº¦æ»‘å—
            document.getElementById('fieldDensity').addEventListener('input', function() {
                const density = parseInt(this.value);
                document.getElementById('densityValue').textContent = density;
                document.getElementById('totalFieldLines').textContent = density * density;
                document.getElementById('crossingFieldLines').textContent = Math.floor(density * density / 2);
                drawFieldLinesDemo();
            });
            
            // æµ‹è¯•å‡ ä½•å› å­æ»‘å—
            document.getElementById('testGeometricFactor').addEventListener('input', function() {
                const factor = parseFloat(this.value);
                document.getElementById('testFactorValue').textContent = factor.toFixed(1);
                updateExperimentResults(factor);
            });
        }
        
        // ç«‹ä½“è§’æ¼”ç¤º
        function drawSolidAngleDemo() {
            const canvas = document.getElementById('solidAngleCanvas');
            const ctx = canvas.getContext('2d');
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶èƒŒæ™¯ç½‘æ ¼
            ctx.strokeStyle = 'rgba(255,255,255,0.1)';
            ctx.lineWidth = 1;
            for (let i = 0; i < canvas.width; i += 20) {
                ctx.beginPath();
                ctx.moveTo(i, 0);
                ctx.lineTo(i, canvas.height);
                ctx.stroke();
            }
            for (let i = 0; i < canvas.height; i += 20) {
                ctx.beginPath();
                ctx.moveTo(0, i);
                ctx.lineTo(canvas.width, i);
                ctx.stroke();
            }
            
            // ç»˜åˆ¶3Dçƒä½“ï¼ˆå·¦ä¾§ï¼‰
            const leftCenter = centerX - 150;
            ctx.fillStyle = 'rgba(79, 195, 247, 0.3)';
            ctx.strokeStyle = 'rgba(79, 195, 247, 0.8)';
            ctx.lineWidth = 2;
            
            // çƒä½“ä¸»ä½“
            ctx.beginPath();
            ctx.arc(leftCenter, centerY, 80, 0, 2 * Math.PI);
            ctx.fill();
            ctx.stroke();
            
            // çƒä½“ç»çº¬çº¿
            ctx.strokeStyle = 'rgba(79, 195, 247, 0.5)';
            ctx.lineWidth = 1;
            for (let i = 0; i < 6; i++) {
                const angle = (i / 6) * Math.PI;
                ctx.beginPath();
                ctx.ellipse(leftCenter, centerY, 80 * Math.sin(angle), 20, 0, 0, 2 * Math.PI);
                ctx.stroke();
            }
            
            // ç»˜åˆ¶åœºçº¿
            ctx.strokeStyle = 'rgba(255, 107, 107, 0.8)';
            ctx.lineWidth = 2;
            for (let i = 0; i < 12; i++) {
                const angle = (i / 12) * 2 * Math.PI + rotationAngle;
                const startX = leftCenter + 80 * Math.cos(angle);
                const startY = centerY + 40 * Math.sin(angle);
                const endX = leftCenter + 120 * Math.cos(angle);
                const endY = centerY + 60 * Math.sin(angle);
                
                ctx.beginPath();
                ctx.moveTo(startX, startY);
                ctx.lineTo(endX, endY);
                ctx.stroke();
                
                // ç®­å¤´
                const arrowAngle = Math.atan2(endY - startY, endX - startX);
                ctx.beginPath();
                ctx.moveTo(endX, endY);
                ctx.lineTo(endX - 10 * Math.cos(arrowAngle - 0.3), endY - 10 * Math.sin(arrowAngle - 0.3));
                ctx.moveTo(endX, endY);
                ctx.lineTo(endX - 10 * Math.cos(arrowAngle + 0.3), endY - 10 * Math.sin(arrowAngle + 0.3));
                ctx.stroke();
            }
            
            // ç»˜åˆ¶2DæŠ•å½±å¹³é¢ï¼ˆå³ä¾§ï¼‰
            const rightCenter = centerX + 150;
            ctx.fillStyle = 'rgba(102, 187, 106, 0.3)';
            ctx.strokeStyle = 'rgba(102, 187, 106, 0.8)';
            ctx.lineWidth = 2;
            
            ctx.beginPath();
            ctx.arc(rightCenter, centerY, 80, 0, 2 * Math.PI);
            ctx.fill();
            ctx.stroke();
            
            // æŠ•å½±åœºçº¿ï¼ˆåªæœ‰ä¸€åŠï¼‰
            ctx.strokeStyle = 'rgba(255, 193, 7, 0.8)';
            ctx.lineWidth = 2;
            for (let i = 0; i < 6; i++) {
                const angle = (i / 6) * Math.PI + rotationAngle;
                const startX = rightCenter + 80 * Math.cos(angle);
                const startY = centerY + 80 * Math.sin(angle);
                const endX = rightCenter + 120 * Math.cos(angle);
                const endY = centerY + 120 * Math.sin(angle);
                
                ctx.beginPath();
                ctx.moveTo(startX, startY);
                ctx.lineTo(endX, endY);
                ctx.stroke();
                
                // ç®­å¤´
                const arrowAngle = Math.atan2(endY - startY, endX - startX);
                ctx.beginPath();
                ctx.moveTo(endX, endY);
                ctx.lineTo(endX - 8 * Math.cos(arrowAngle - 0.3), endY - 8 * Math.sin(arrowAngle - 0.3));
                ctx.moveTo(endX, endY);
                ctx.lineTo(endX - 8 * Math.cos(arrowAngle + 0.3), endY - 8 * Math.sin(arrowAngle + 0.3));
                ctx.stroke();
            }
            
            // è¿æ¥çº¿
            ctx.strokeStyle = 'rgba(255,255,255,0.5)';
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(leftCenter + 80, centerY);
            ctx.lineTo(rightCenter - 80, centerY);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // æ ‡ç­¾
            ctx.fillStyle = 'white';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('3Dçƒä½“ (4Ï€ç«‹ä½“è§’)', leftCenter, centerY + 120);
            ctx.fillText('2DæŠ•å½± (2Ï€ç«‹ä½“è§’)', rightCenter, centerY + 120);
            
            // å‡ ä½•å› å­æ˜¾ç¤º
            ctx.font = 'bold 20px Arial';
            ctx.fillStyle = '#ffd54f';
            ctx.fillText('å‡ ä½•å› å­ = 4Ï€/2Ï€ = 2', centerX, 50);
        }
        
        function startSolidAngleDemo() {
            if (!isAnimating) {
                isAnimating = true;
                animateSolidAngle();
            }
        }
        
        function resetSolidAngleDemo() {
            isAnimating = false;
            rotationAngle = 0;
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            drawSolidAngleDemo();
        }
        
        function animateSolidAngle() {
            if (!isAnimating) return;
            
            const speed = parseFloat(document.getElementById('rotationSpeed').value);
            rotationAngle += 0.02 * speed;
            
            drawSolidAngleDemo();
            animationId = requestAnimationFrame(animateSolidAngle);
        }
        
        // åœºçº¿äº¤å‰æ¼”ç¤º
        function drawFieldLinesDemo() {
            const canvas = document.getElementById('fieldLinesCanvas');
            const ctx = canvas.getContext('2d');
            const centerY = canvas.height / 2;
            const mass1X = 200;
            const mass2X = 600;
            const density = parseInt(document.getElementById('fieldDensity').value);
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶èƒŒæ™¯
            ctx.fillStyle = 'rgba(0,0,0,0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶è´¨é‡ä½“1
            ctx.fillStyle = 'rgba(79, 195, 247, 0.8)';
            ctx.beginPath();
            ctx.arc(mass1X, centerY, 30, 0, 2 * Math.PI);
            ctx.fill();
            
            // ç»˜åˆ¶è´¨é‡ä½“2
            ctx.fillStyle = 'rgba(255, 99, 132, 0.8)';
            ctx.beginPath();
            ctx.arc(mass2X, centerY, 30, 0, 2 * Math.PI);
            ctx.fill();
            
            // ç»˜åˆ¶ç›¸äº’ä½œç”¨å¹³é¢
            const planeX = (mass1X + mass2X) / 2;
            ctx.strokeStyle = 'rgba(102, 187, 106, 0.8)';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(planeX, 50);
            ctx.lineTo(planeX, canvas.height - 50);
            ctx.stroke();
            
            // ç»˜åˆ¶åœºçº¿
            let crossingLines = 0;
            const totalLines = density;
            
            // è´¨é‡ä½“1çš„åœºçº¿
            ctx.strokeStyle = 'rgba(79, 195, 247, 0.6)';
            ctx.lineWidth = 2;
            for (let i = 0; i < totalLines; i++) {
                const angle = (i / totalLines) * 2 * Math.PI;
                const startX = mass1X + 35 * Math.cos(angle);
                const startY = centerY + 35 * Math.sin(angle);
                const endX = mass1X + 150 * Math.cos(angle);
                const endY = centerY + 150 * Math.sin(angle);
                
                ctx.beginPath();
                ctx.moveTo(startX, startY);
                ctx.lineTo(endX, endY);
                ctx.stroke();
                
                // æ£€æŸ¥æ˜¯å¦ç©¿è¿‡ç›¸äº’ä½œç”¨å¹³é¢
                if (endX > planeX && startX < planeX) {
                    crossingLines++;
                    // é«˜äº®äº¤å‰åœºçº¿
                    ctx.strokeStyle = 'rgba(255, 193, 7, 0.9)';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.moveTo(startX, startY);
                    ctx.lineTo(planeX, startY + (endY - startY) * (planeX - startX) / (endX - startX));
                    ctx.stroke();
                    ctx.strokeStyle = 'rgba(79, 195, 247, 0.6)';
                    ctx.lineWidth = 2;
                }
            }
            
            // è´¨é‡ä½“2çš„åœºçº¿
            ctx.strokeStyle = 'rgba(255, 99, 132, 0.6)';
            for (let i = 0; i < totalLines; i++) {
                const angle = (i / totalLines) * 2 * Math.PI;
                const startX = mass2X + 35 * Math.cos(angle);
                const startY = centerY + 35 * Math.sin(angle);
                const endX = mass2X - 150 * Math.cos(angle);
                const endY = centerY - 150 * Math.sin(angle);
                
                ctx.beginPath();
                ctx.moveTo(startX, startY);
                ctx.lineTo(endX, endY);
                ctx.stroke();
                
                // æ£€æŸ¥æ˜¯å¦ç©¿è¿‡ç›¸äº’ä½œç”¨å¹³é¢
                if (endX < planeX && startX > planeX) {
                    // é«˜äº®äº¤å‰åœºçº¿
                    ctx.strokeStyle = 'rgba(255, 193, 7, 0.9)';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.moveTo(startX, startY);
                    ctx.lineTo(planeX, startY + (endY - startY) * (planeX - startX) / (endX - startX));
                    ctx.stroke();
                    ctx.strokeStyle = 'rgba(255, 99, 132, 0.6)';
                    ctx.lineWidth = 2;
                }
            }
            
            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            document.getElementById('totalFieldLines').textContent = totalLines * 2;
            document.getElementById('crossingFieldLines').textContent = crossingLines * 2;
            document.getElementById('interactionRatio').textContent = (crossingLines / totalLines).toFixed(2);
            
            // æ ‡ç­¾
            ctx.fillStyle = 'white';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('è´¨é‡ä½“1', mass1X, centerY + 60);
            ctx.fillText('è´¨é‡ä½“2', mass2X, centerY + 60);
            ctx.fillText('ç›¸äº’ä½œç”¨å¹³é¢', planeX, 30);
            
            // è¯´æ˜
            ctx.font = '12px Arial';
            ctx.fillStyle = 'rgba(255, 193, 7, 1)';
            ctx.fillText('é»„è‰²çº¿æ¡ï¼šæœ‰æ•ˆç›¸äº’ä½œç”¨åœºçº¿', canvas.width / 2, canvas.height - 20);
        }
        
        function startFieldLinesDemo() {
            fieldLinesAnimation = true;
            animateFieldLines();
        }
        
        function pauseFieldLinesDemo() {
            fieldLinesAnimation = false;
        }
        
        function resetFieldLinesDemo() {
            fieldLinesAnimation = false;
            drawFieldLinesDemo();
        }
        
        function animateFieldLines() {
            if (!fieldLinesAnimation) return;
            
            // è¿™é‡Œå¯ä»¥æ·»åŠ åœºçº¿çš„åŠ¨æ€æ•ˆæœ
            drawFieldLinesDemo();
            setTimeout(() => animateFieldLines(), 100);
        }
        
        // æ•°å­¦æ¼”ç¤º
        function drawMathDemo() {
            const canvas = document.getElementById('mathCanvas');
            const ctx = canvas.getContext('2d');
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶åæ ‡ç³»
            ctx.strokeStyle = 'rgba(255,255,255,0.3)';
            ctx.lineWidth = 1;
            
            // Xè½´
            ctx.beginPath();
            ctx.moveTo(50, canvas.height / 2);
            ctx.lineTo(canvas.width - 50, canvas.height / 2);
            ctx.stroke();
            
            // Yè½´
            ctx.beginPath();
            ctx.moveTo(canvas.width / 2, 50);
            ctx.lineTo(canvas.width / 2, canvas.height - 50);
            ctx.stroke();
            
            // ç»˜åˆ¶ç§¯åˆ†åŒºåŸŸå¯è§†åŒ–
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            
            // ç»˜åˆ¶çƒåæ ‡ç³»
            ctx.strokeStyle = 'rgba(79, 195, 247, 0.8)';
            ctx.lineWidth = 2;
            
            // Î¸è§’åº¦å¼§çº¿
            for (let theta = 0; theta <= Math.PI; theta += Math.PI / 6) {
                const radius = 100 * Math.sin(theta);
                if (radius > 0) {
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
                    ctx.stroke();
                }
            }
            
            // Ï†è§’åº¦å°„çº¿
            for (let phi = 0; phi < 2 * Math.PI; phi += Math.PI / 6) {
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(centerX + 100 * Math.cos(phi), centerY + 100 * Math.sin(phi));
                ctx.stroke();
            }
            
            // æ ‡æ³¨
            ctx.fillStyle = 'white';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Î¸ (æè§’)', centerX - 120, centerY - 80);
            ctx.fillText('Ï† (æ–¹ä½è§’)', centerX + 120, centerY + 100);
            
            // ç§¯åˆ†å…¬å¼
            ctx.font = '16px Arial';
            ctx.fillStyle = '#ffd54f';
            ctx.fillText('åŒé‡ç«‹ä½“è§’ç§¯åˆ†', centerX, 30);
            
            ctx.font = '12px Arial';
            ctx.fillStyle = 'white';
            ctx.fillText('âˆ«âˆ«âˆ«âˆ« sinÂ²Î¸â‚ sinÂ²Î¸â‚‚ cosÂ²(Ï†â‚-Ï†â‚‚) dÎ¸â‚dÏ†â‚dÎ¸â‚‚dÏ†â‚‚', centerX, canvas.height - 30);
        }
        
        function showIntegralSteps() {
            // é«˜äº®æ˜¾ç¤ºç§¯åˆ†æ­¥éª¤
            const steps = document.querySelectorAll('.step');
            steps.forEach((step, index) => {
                setTimeout(() => {
                    step.classList.add('fade-in');
                    step.style.background = 'rgba(255, 193, 7, 0.2)';
                    setTimeout(() => {
                        step.style.background = 'rgba(255,255,255,0.1)';
                    }, 1000);
                }, index * 500);
            });
        }
        
        function showGeometricProof() {
            // æ˜¾ç¤ºå‡ ä½•è¯æ˜
            alert('å‡ ä½•è¯æ˜ï¼š\n\n1. ä¸‰ç»´ç©ºé—´ä¸­çš„åœºè¦†ç›–4Ï€ç«‹ä½“è§’\n2. äºŒç»´å¹³é¢ä¸Šçš„æœ‰æ•ˆç›¸äº’ä½œç”¨å¯¹åº”2Ï€ç«‹ä½“è§’\n3. å‡ ä½•å› å­ = 4Ï€/2Ï€ = 2\n\nè¿™æ˜¯çº¯å‡ ä½•çš„å¿…ç„¶ç»“æœï¼');
        }
        
        function showNumericalVerification() {
            // æ•°å€¼éªŒè¯
            const result = monteCarloVerification(100000);
            alert(`è’™ç‰¹å¡ç½—æ•°å€¼éªŒè¯ç»“æœï¼š\n\né‡‡æ ·ç‚¹æ•°ï¼š100,000\nè®¡ç®—å¾—åˆ°çš„å‡ ä½•å› å­ï¼š${result.toFixed(4)}\nç†è®ºå€¼ï¼š2.0000\n\néªŒè¯é€šè¿‡ï¼`);
        }
        
        function monteCarloVerification(samples) {
            let sum = 0;
            for (let i = 0; i < samples; i++) {
                const theta1 = Math.acos(1 - 2 * Math.random());
                const phi1 = 2 * Math.PI * Math.random();
                const theta2 = Math.acos(1 - 2 * Math.random());
                const phi2 = 2 * Math.PI * Math.random();
                
                const interaction = Math.sin(theta1) * Math.sin(theta2) * Math.pow(Math.cos(phi1 - phi2), 2);
                sum += interaction;
            }
            
            const average = sum / samples;
            return average * 16 * Math.PI * Math.PI / (Math.PI * Math.PI * Math.PI * Math.PI) * 64;
        }
        
        // å®éªŒæ¼”ç¤º
        function drawExperimentDemo() {
            const canvas = document.getElementById('experimentCanvas');
            const ctx = canvas.getContext('2d');
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶å®éªŒè£…ç½®ç¤ºæ„å›¾
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            
            // ç»˜åˆ¶Gå€¼æµ‹é‡è£…ç½®
            ctx.strokeStyle = 'rgba(255,255,255,0.8)';
            ctx.lineWidth = 2;
            
            // æ‰­ç§¤
            ctx.beginPath();
            ctx.rect(centerX - 100, centerY - 50, 200, 100);
            ctx.stroke();
            
            ctx.fillStyle = 'white';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('å¼•åŠ›å¸¸æ•°æµ‹é‡è£…ç½®', centerX, centerY - 80);
            
            // æµ‹é‡ç»“æœæ˜¾ç¤º
            ctx.font = '16px Arial';
            ctx.fillStyle = '#4fc3f7';
            ctx.fillText('CODATA 2018: G = 6.67430 Ã— 10â»Â¹Â¹', centerX, centerY);
            
            ctx.fillStyle = '#66bb6a';
            ctx.fillText('ç†è®ºè®¡ç®—: G = 2Z/c', centerX, centerY + 30);
            
            // è¯¯å·®åˆ†æå›¾
            drawErrorBar(ctx, centerX, centerY + 80, 0); // 0% è¯¯å·®
        }
        
        function drawErrorBar(ctx, x, y, error) {
            const barWidth = 200;
            const maxError = 50; // æœ€å¤§50%è¯¯å·®
            
            // èƒŒæ™¯æ¡
            ctx.fillStyle = 'rgba(255,255,255,0.2)';
            ctx.fillRect(x - barWidth/2, y - 10, barWidth, 20);
            
            // è¯¯å·®æ¡
            const errorWidth = (Math.abs(error) / maxError) * barWidth;
            ctx.fillStyle = error === 0 ? '#28a745' : '#dc3545';
            ctx.fillRect(x - errorWidth/2, y - 10, errorWidth, 20);
            
            // æ ‡ç­¾
            ctx.fillStyle = 'white';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(`è¯¯å·®: ${error.toFixed(2)}%`, x, y + 35);
        }
        
        function runExperimentSimulation() {
            // æ¨¡æ‹Ÿå®éªŒè¿‡ç¨‹
            const canvas = document.getElementById('experimentCanvas');
            const ctx = canvas.getContext('2d');
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 2;
                
                // ç»˜åˆ¶è¿›åº¦æ¡
                ctx.fillStyle = 'rgba(0,0,0,0.5)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = 'white';
                ctx.font = '18px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('å®éªŒæ¨¡æ‹Ÿè¿›è¡Œä¸­...', canvas.width/2, canvas.height/2 - 30);
                
                // è¿›åº¦æ¡
                const barWidth = 300;
                const barHeight = 20;
                const x = (canvas.width - barWidth) / 2;
                const y = canvas.height / 2;
                
                ctx.strokeStyle = 'white';
                ctx.strokeRect(x, y, barWidth, barHeight);
                
                ctx.fillStyle = '#4fc3f7';
                ctx.fillRect(x, y, (progress / 100) * barWidth, barHeight);
                
                ctx.fillStyle = 'white';
                ctx.font = '14px Arial';
                ctx.fillText(`${progress}%`, canvas.width/2, y + 35);
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        drawExperimentDemo();
                        alert('å®éªŒæ¨¡æ‹Ÿå®Œæˆï¼\n\nç»“æœï¼šå‡ ä½•å› å­=2æ—¶ï¼Œç†è®ºå€¼ä¸å®éªŒå€¼å®Œç¾å»åˆï¼');
                    }, 500);
                }
            }, 50);
        }
        
        function compareWithCODATA() {
            const factor = parseFloat(document.getElementById('testGeometricFactor').value);
            updateExperimentResults(factor);
            
            if (Math.abs(factor - 2.0) < 0.1) {
                alert('ğŸ‰ æ­å–œï¼\n\nå½“å‡ ä½•å› å­æ¥è¿‘2æ—¶ï¼Œç†è®ºè®¡ç®—å€¼ä¸CODATAå®éªŒå€¼é«˜åº¦å»åˆï¼\nè¿™è¯æ˜äº†å‡ ä½•å› å­2çš„æ­£ç¡®æ€§ã€‚');
            } else {
                alert('âš ï¸ æ³¨æ„ï¼\n\nå½“å‡ ä½•å› å­åç¦»2æ—¶ï¼Œç†è®ºå€¼ä¸å®éªŒå€¼å‡ºç°æ˜¾è‘—åå·®ã€‚\nåªæœ‰å‡ ä½•å› å­=2æ—¶æ‰èƒ½è·å¾—æ­£ç¡®ç»“æœã€‚');
            }
        }
        
        function updateExperimentResults(factor) {
            const Z = 0.0100065;
            const c = 299792458;
            const codataG = 6.67430;
            
            const calculatedG = (factor * Z * 1e11) / c * 2;
            const error = ((calculatedG - codataG) / codataG) * 100;
            
            document.getElementById('calculatedG').textContent = calculatedG.toFixed(3);
            document.getElementById('codataG').textContent = codataG.toFixed(3);
            document.getElementById('relativeError').textContent = error.toFixed(2) + '%';
            document.getElementById('relativeError').style.color = Math.abs(error) < 1 ? '#28a745' : '#dc3545';
            
            // é‡ç»˜å®éªŒæ¼”ç¤º
            drawExperimentDemo();
        }
    </script>
</body>
</html>