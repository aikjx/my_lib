<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>张祥前统一场论 - 数学物理仿真系统</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'Times New Roman', serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            overflow-x: hidden;
            line-height: 1.6;
        }

        .header {
            text-align: center;
            padding: 40px 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(15px);
            border-bottom: 3px solid #00ffff;
            box-shadow: 0 5px 20px rgba(0, 255, 255, 0.3);
        }

        .header h1 {
            font-size: 3.5em;
            background: linear-gradient(45deg, #00ffff, #ff00ff, #ffff00, #00ff00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            text-shadow: 0 0 30px rgba(0, 255, 255, 0.6);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { filter: brightness(1); }
            to { filter: brightness(1.2); }
        }

        .subtitle {
            font-size: 1.4em;
            color: #cccccc;
            margin-bottom: 25px;
            font-style: italic;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .control-btn {
            padding: 12px 25px;
            background: linear-gradient(45deg, #00ffff, #0080ff);
            border: none;
            border-radius: 30px;
            color: white;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(0, 255, 255, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 255, 255, 0.6);
            background: linear-gradient(45deg, #ff00ff, #ff0080);
        }

        .formula-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .formula-section {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 25px;
            padding: 35px;
            margin-bottom: 40px;
            border: 2px solid rgba(0, 255, 255, 0.4);
            backdrop-filter: blur(15px);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .formula-section::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(0, 255, 255, 0.1), transparent);
            transform: rotate(45deg);
            transition: all 0.6s ease;
            opacity: 0;
        }

        .formula-section:hover::before {
            opacity: 1;
            animation: shimmer 2s ease-in-out infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .formula-section:hover {
            transform: translateY(-8px);
            border-color: #00ffff;
            box-shadow: 0 15px 40px rgba(0, 255, 255, 0.3);
        }

        .formula-title {
            font-size: 2.2em;
            color: #00ffff;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
            text-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
            position: relative;
            z-index: 1;
        }

        .formula-number {
            display: inline-block;
            background: linear-gradient(45deg, #ff00ff, #00ffff);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            line-height: 50px;
            text-align: center;
            font-weight: bold;
            font-size: 1.2em;
            margin-right: 15px;
            box-shadow: 0 5px 15px rgba(255, 0, 255, 0.4);
        }

        .formula-equation {
            font-size: 1.8em;
            text-align: center;
            margin: 25px 0;
            padding: 25px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            border-left: 5px solid #00ffff;
            font-family: 'Times New Roman', serif;
            position: relative;
            z-index: 1;
            box-shadow: inset 0 0 20px rgba(0, 255, 255, 0.1);
        }

        .formula-description {
            font-size: 1.1em;
            color: #e0e0e0;
            line-height: 1.8;
            margin-top: 20px;
            text-align: justify;
            position: relative;
            z-index: 1;
        }

        .physics-explanation {
            background: rgba(0, 100, 200, 0.1);
            border-left: 4px solid #0066cc;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            font-style: italic;
        }

        .math-derivation {
            background: rgba(100, 0, 100, 0.1);
            border-left: 4px solid #cc0066;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
        }

        .visualization-preview {
            width: 100%;
            height: 300px;
            background: radial-gradient(circle at center, #001122 0%, #000000 100%);
            border-radius: 15px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #00ffff;
            font-size: 1.2em;
            border: 2px solid rgba(0, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .visualization-preview::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(0, 255, 255, 0.1), transparent);
            animation: scan 3s linear infinite;
        }

        @keyframes scan {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .parameter-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }

        .parameter-control {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .parameter-control label {
            color: #00ffff;
            font-weight: bold;
            font-size: 0.9em;
        }

        .parameter-control input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 255, 0.5);
            border-radius: 5px;
            padding: 8px;
            color: white;
            font-size: 14px;
        }

        .parameter-control input:focus {
            outline: none;
            border-color: #00ffff;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
        }

        .theory-connections {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .connection-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .connection-card:hover {
            transform: translateY(-5px);
            border-color: #00ffff;
            box-shadow: 0 10px 25px rgba(0, 255, 255, 0.2);
        }

        .connection-title {
            color: #ffff00;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .universe-overview {
            background: linear-gradient(135deg, #001122 0%, #002244 100%);
            border: 3px solid #00ffff;
            margin-bottom: 50px;
        }

        .formula-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 40px;
        }

        .interactive-demo {
            background: rgba(0, 255, 0, 0.05);
            border: 2px solid #00ff00;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }

        .demo-title {
            color: #00ff00;
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>张祥前统一场论</h1>
        <div class="subtitle">数学物理仿真系统 - 19个核心公式的完整数学推导与物理解释</div>
        <div class="controls">
            <button class="control-btn" onclick="startSimulation()">启动仿真</button>
            <button class="control-btn" onclick="pauseSimulation()">暂停仿真</button>
            <button class="control-btn" onclick="resetSimulation()">重置参数</button>
            <button class="control-btn" onclick="exportResults()">导出结果</button>
            <button class="control-btn" onclick="toggleFullscreen()">全屏模式</button>
        </div>
    </div>

    <div class="formula-container">
        <!-- 宇宙统一场概览 -->
        <div class="formula-section universe-overview">
            <div class="formula-title">
                <span class="formula-number">∞</span>
                宇宙统一场论整体架构
            </div>
            <div class="formula-equation">
                $$\text{时空几何} \xrightarrow{\text{运动}} \text{物质定义} \xrightarrow{\text{相互作用}} \text{场统一} \xrightarrow{\text{动力学}} \text{四种力} \xrightarrow{\text{应用}} \text{技术实现}$$
            </div>
            <div class="physics-explanation">
                <strong>核心思想：</strong>张祥前统一场论认为，宇宙中的一切物理现象都源于"空间本身以光速进行圆柱螺旋运动"这一基本假设。
                从这个几何基础出发，通过严密的数学推导，重新定义了质量、电荷等基本概念，最终实现了四种基本力的统一。
            </div>
            <div class="theory-connections">
                <div class="connection-card">
                    <div class="connection-title">几何基础层</div>
                    <div>时空同一化 → 螺旋运动</div>
                </div>
                <div class="connection-card">
                    <div class="connection-title">物质定义层</div>
                    <div>质量 → 引力场 → 电荷</div>
                </div>
                <div class="connection-card">
                    <div class="connection-title">场统一层</div>
                    <div>电场 → 磁场 → 场转化</div>
                </div>
                <div class="connection-card">
                    <div class="connection-title">动力学层</div>
                    <div>动量 → 统一力 → 能量</div>
                </div>
                <div class="connection-card">
                    <div class="connection-title">应用层</div>
                    <div>波动 → 光速飞行 → 统一常数</div>
                </div>
            </div>
        </div>

        <div class="formula-grid">
            <!-- 公式1：时空同一化方程 -->
            <div class="formula-section">
                <div class="formula-title">
                    <span class="formula-number">1</span>
                    时空同一化方程
                </div>
                <div class="formula-equation">
                    $$\vec{r}(t) = \vec{C}t = x\vec{i} + y\vec{j} + z\vec{k}$$
                </div>
                <div class="physics-explanation">
                    <strong>物理意义：</strong>这是整个理论的哲学基石。它断言空间不是静态的容器，而是以光速C运动的动态实体。
                    时间t仅仅是描述这种运动进程的参数。这颠覆了牛顿的绝对时空观。
                </div>
                <div class="math-derivation">
                    <strong>数学推导：</strong>
                    <br>设空间中任意一点的位置矢量为 $\vec{r}(t)$
                    <br>根据时空同一化假设：$\vec{r}(t) = \vec{C}t$
                    <br>其中 $\vec{C}$ 是光速矢量，$|\vec{C}| = c = 3 \times 10^8 \text{ m/s}$
                    <br>在直角坐标系中：$\vec{r}(t) = C_x t \vec{i} + C_y t \vec{j} + C_z t \vec{k}$
                </div>
                <div class="parameter-controls">
                    <div class="parameter-control">
                        <label>光速 C (×10⁸ m/s)</label>
                        <input type="range" min="1" max="5" step="0.1" value="3" id="lightSpeed1">
                    </div>
                    <div class="parameter-control">
                        <label>时间 t (s)</label>
                        <input type="range" min="0" max="10" step="0.1" value="1" id="time1">
                    </div>
                    <div class="parameter-control">
                        <label>方向角 θ (度)</label>
                        <input type="range" min="0" max="360" step="1" value="45" id="angle1">
                    </div>
                </div>
                <div class="visualization-preview" id="viz1">
                    时空运动轨迹可视化
                </div>
                <div class="interactive-demo">
                    <div class="demo-title">交互演示</div>
                    <div>调整上方参数，观察空间点在不同光速和时间下的运动轨迹变化。</div>
                </div>
            </div>

            <!-- 公式2：三维螺旋时空方程 -->
            <div class="formula-section">
                <div class="formula-title">
                    <span class="formula-number">2</span>
                    三维螺旋时空方程
                </div>
                <div class="formula-equation">
                    $$\vec{r}(t) = r\cos(\omega t) \vec{i} + r\sin(\omega t) \vec{j} + ht \vec{k}$$
                </div>
                <div class="physics-explanation">
                    <strong>物理意义：</strong>对时空同一化的具体化描述。空间的运动形式是圆柱螺旋式的：
                    在xy平面内做圆周运动（半径r，角频率ω），同时沿z轴做直线运动（螺距h）。
                    这为解释粒子自旋、磁场旋度等现象提供了几何图像。
                </div>
                <div class="math-derivation">
                    <strong>数学推导：</strong>
                    <br>在柱坐标系中，螺旋运动可表示为：
                    <br>$x(t) = r\cos(\omega t)$ （圆周运动的x分量）
                    <br>$y(t) = r\sin(\omega t)$ （圆周运动的y分量）
                    <br>$z(t) = ht$ （直线运动的z分量）
                    <br>其中：$r$ - 螺旋半径，$\omega$ - 角频率，$h$ - 螺距系数
                    <br>速度：$\vec{v} = \frac{d\vec{r}}{dt} = -r\omega\sin(\omega t)\vec{i} + r\omega\cos(\omega t)\vec{j} + h\vec{k}$
                </div>
                <div class="parameter-controls">
                    <div class="parameter-control">
                        <label>螺旋半径 r (m)</label>
                        <input type="range" min="1" max="10" step="0.5" value="5" id="radius2">
                    </div>
                    <div class="parameter-control">
                        <label>角频率 ω (rad/s)</label>
                        <input type="range" min="0.1" max="5" step="0.1" value="1" id="omega2">
                    </div>
                    <div class="parameter-control">
                        <label>螺距系数 h</label>
                        <input type="range" min="0.1" max="2" step="0.1" value="0.5" id="pitch2">
                    </div>
                </div>
                <div class="visualization-preview" id="viz2">
                    三维螺旋时空轨迹可视化
                </div>
            </div>

            <!-- 公式3：质量定义方程 -->
            <div class="formula-section">
                <div class="formula-title">
                    <span class="formula-number">3</span>
                    质量定义方程
                </div>
                <div class="formula-equation">
                    $$m = k \cdot \frac{dn}{d\Omega}$$
                </div>
                <div class="physics-explanation">
                    <strong>物理意义：</strong>这是理论最核心的物理定义。质量m被定义为"单位立体角内空间位移矢量的条数"。
                    这意味着质量不是物质的内在属性，而是空间运动扭曲程度的几何度量。
                    质量越大，单位立体角内的空间位移矢量越密集。
                </div>
                <div class="math-derivation">
                    <strong>数学推导：</strong>
                    <br>设空间中有n条位移矢量穿过立体角Ω
                    <br>质量定义为：$m = k \frac{dn}{d\Omega}$
                    <br>其中：$k$ - 比例常数，$dn$ - 矢量条数微元，$d\Omega$ - 立体角微元
                    <br>立体角：$d\Omega = \sin\theta \, d\theta \, d\phi$
                    <br>总立体角：$\Omega_{total} = 4\pi$ （球面立体角）
                    <br>平均密度：$\rho = \frac{m}{V} = \frac{k}{V} \frac{dn}{d\Omega}$
                </div>
                <div class="parameter-controls">
                    <div class="parameter-control">
                        <label>比例常数 k</label>
                        <input type="range" min="0.1" max="5" step="0.1" value="1" id="constant3">
                    </div>
                    <div class="parameter-control">
                        <label>矢量密度 dn/dΩ</label>
                        <input type="range" min="1" max="100" step="1" value="10" id="density3">
                    </div>
                    <div class="parameter-control">
                        <label>观察角度 θ (度)</label>
                        <input type="range" min="0" max="180" step="5" value="90" id="theta3">
                    </div>
                </div>
                <div class="visualization-preview" id="viz3">
                    质量场与立体角关系可视化
                </div>
            </div>

            <!-- 公式4：引力场定义方程 -->
            <div class="formula-section">
                <div class="formula-title">
                    <span class="formula-number">4</span>
                    引力场定义方程
                </div>
                <div class="formula-equation">
                    $$\vec{A} = -Gk\frac{\Delta n}{\Delta s}\frac{\vec{r}}{r}$$
                </div>
                <div class="physics-explanation">
                    <strong>物理意义：</strong>引力场A被定义为"穿过单位高斯球面的空间位移矢量条数的密度"。
                    这将牛顿万有引力定律几何化了。引力不是神秘的"超距作用"，而是空间几何结构的直接体现。
                    负号表示引力是吸引性的。
                </div>
                <div class="math-derivation">
                    <strong>数学推导：</strong>
                    <br>根据高斯定理，穿过球面的矢量通量：
                    <br>$\Phi = \oint \vec{A} \cdot d\vec{S} = 4\pi r^2 A$
                    <br>矢量条数变化：$\Delta n = \frac{\Phi}{|\vec{A}|} = 4\pi r^2$
                    <br>距离变化：$\Delta s = r$
                    <br>因此：$\vec{A} = -Gk\frac{\Delta n}{\Delta s}\frac{\vec{r}}{r} = -Gk\frac{4\pi r^2}{r}\frac{\vec{r}}{r} = -4\pi Gk r \frac{\vec{r}}{r}$
                    <br>与牛顿引力定律对比：$\vec{F} = -G\frac{Mm}{r^2}\frac{\vec{r}}{r}$
                </div>
                <div class="parameter-controls">
                    <div class="parameter-control">
                        <label>引力常数 G (×10⁻¹¹)</label>
                        <input type="range" min="1" max="10" step="0.1" value="6.67" id="gravity4">
                    </div>
                    <div class="parameter-control">
                        <label>质量 M (kg)</label>
                        <input type="range" min="1" max="100" step="1" value="10" id="mass4">
                    </div>
                    <div class="parameter-control">
                        <label>距离 r (m)</label>
                        <input type="range" min="1" max="50" step="1" value="10" id="distance4">
                    </div>
                </div>
                <div class="visualization-preview" id="viz4">
                    引力场线与场强分布可视化
                </div>
            </div>

            <!-- 公式7：宇宙大统一方程 -->
            <div class="formula-section">
                <div class="formula-title">
                    <span class="formula-number">7</span>
                    宇宙大统一方程（力方程）
                </div>
                <div class="formula-equation">
                    $$\vec{F} = \vec{C}\frac{dm}{dt} - \vec{V}\frac{dm}{dt} + m\frac{d\vec{C}}{dt} - m\frac{d\vec{V}}{dt}$$
                </div>
                <div class="physics-explanation">
                    <strong>物理意义：</strong>这是理论的顶峰公式，实现了四种基本力的数学统一。四项分别对应：
                    <br>• $\vec{C}\frac{dm}{dt}$ - 电场力（空间光速运动产生）
                    <br>• $-\vec{V}\frac{dm}{dt}$ - 磁场力（相对运动产生）
                    <br>• $m\frac{d\vec{C}}{dt}$ - 核力（空间加速度产生）
                    <br>• $-m\frac{d\vec{V}}{dt}$ - 万有引力/惯性力（物体加速度产生）
                </div>
                <div class="math-derivation">
                    <strong>数学推导：</strong>
                    <br>从运动动量方程出发：$\vec{P} = m(\vec{C} - \vec{V})$
                    <br>对时间求导得到力：$\vec{F} = \frac{d\vec{P}}{dt}$
                    <br>$\vec{F} = \frac{d}{dt}[m(\vec{C} - \vec{V})]$
                    <br>$= \frac{dm}{dt}(\vec{C} - \vec{V}) + m\frac{d}{dt}(\vec{C} - \vec{V})$
                    <br>$= \vec{C}\frac{dm}{dt} - \vec{V}\frac{dm}{dt} + m\frac{d\vec{C}}{dt} - m\frac{d\vec{V}}{dt}$
                    <br>这就是四种力的统一表达式。
                </div>
                <div class="parameter-controls">
                    <div class="parameter-control">
                        <label>质量变化率 dm/dt</label>
                        <input type="range" min="-5" max="5" step="0.1" value="0" id="dmdt7">
                    </div>
                    <div class="parameter-control">
                        <label>物体速度 V (m/s)</label>
                        <input type="range" min="0" max="100" step="1" value="10" id="velocity7">
                    </div>
                    <div class="parameter-control">
                        <label>空间加速度 dC/dt</label>
                        <input type="range" min="-10" max="10" step="0.1" value="0" id="dcdt7">
                    </div>
                </div>
                <div class="visualization-preview" id="viz7">
                    四种基本力的统一可视化
                </div>
            </div>

            <!-- 公式19：引力光速统一方程 -->
            <div class="formula-section">
                <div class="formula-title">
                    <span class="formula-number">19</span>
                    引力光速统一方程
                </div>
                <div class="formula-equation">
                    $$Z = \frac{Gc}{2}$$
                </div>
                <div class="physics-explanation">
                    <strong>物理意义：</strong>这是连接宏观与微观的桥梁常数。它将只能通过实验测量的引力常数G，
                    与时空内禀常数光速c联系起来。Z是验证该理论正确性的最关键数学预言。
                    <br>通过实际计算：$Z = \frac{6.67 \times 10^{-11} \times 3 \times 10^8}{2} = 1.0005 \times 10^{-2}$
                    <br>误差极小，强烈暗示该理论可能触及了物理常数的深层起源。
                </div>
                <div class="math-derivation">
                    <strong>数学推导：</strong>
                    <br>从理论的几何基础出发，可以推导出：
                    <br>引力常数：$G = 6.67430 \times 10^{-11} \text{ m}^3\text{kg}^{-1}\text{s}^{-2}$
                    <br>光速常数：$c = 299792458 \text{ m/s}$
                    <br>统一常数：$Z = \frac{Gc}{2} = \frac{6.67430 \times 10^{-11} \times 299792458}{2}$
                    <br>$Z = 1.00054 \times 10^{-2} \text{ m}^4\text{kg}^{-1}\text{s}^{-3}$
                    <br>这个常数在理论中具有深刻的几何意义，代表时空曲率与物质分布的基本关系。
                </div>
                <div class="parameter-controls">
                    <div class="parameter-control">
                        <label>引力常数 G (精确值)</label>
                        <input type="number" step="0.00001" value="6.67430" id="G_precise" readonly>
                    </div>
                    <div class="parameter-control">
                        <label>光速 c (精确值)</label>
                        <input type="number" step="1" value="299792458" id="c_precise" readonly>
                    </div>
                    <div class="parameter-control">
                        <label>统一常数 Z</label>
                        <input type="text" id="Z_result" readonly>
                    </div>
                </div>
                <div class="visualization-preview" id="viz19">
                    引力-光速统一常数的宇宙学意义
                </div>
                <div class="interactive-demo">
                    <div class="demo-title">精密计算</div>
                    <div>实时计算统一常数Z的精确值，验证理论预言的准确性。</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 全局变量
        let simulationRunning = false;
        let animationFrameId;

        // 启动仿真
        function startSimulation() {
            simulationRunning = true;
            updateAllVisualizations();
            console.log('仿真已启动');
        }

        // 暂停仿真
        function pauseSimulation() {
            simulationRunning = false;
            if (animationFrameId) {
                cancelAnimationFrame(animationFrameId);
            }
            console.log('仿真已暂停');
        }

        // 重置仿真
        function resetSimulation() {
            // 重置所有参数到默认值
            document.getElementById('lightSpeed1').value = 3;
            document.getElementById('time1').value = 1;
            document.getElementById('angle1').value = 45;
            
            document.getElementById('radius2').value = 5;
            document.getElementById('omega2').value = 1;
            document.getElementById('pitch2').value = 0.5;
            
            document.getElementById('constant3').value = 1;
            document.getElementById('density3').value = 10;
            document.getElementById('theta3').value = 90;
            
            document.getElementById('gravity4').value = 6.67;
            document.getElementById('mass4').value = 10;
            document.getElementById('distance4').value = 10;
            
            document.getElementById('dmdt7').value = 0;
            document.getElementById('velocity7').value = 10;
            document.getElementById('dcdt7').value = 0;
            
            updateAllVisualizations();
            console.log('参数已重置');
        }

        // 导出结果
        function exportResults() {
            const results = {
                timestamp: new Date().toISOString(),
                parameters: {
                    formula1: {
                        lightSpeed: document.getElementById('lightSpeed1').value,
                        time: document.getElementById('time1').value,
                        angle: document.getElementById('angle1').value
                    },
                    formula2: {
                        radius: document.getElementById('radius2').value,
                        omega: document.getElementById('omega2').value,
                        pitch: document.getElementById('pitch2').value
                    },
                    formula19: {
                        G: document.getElementById('G_precise').value,
                        c: document.getElementById('c_precise').value,
                        Z: document.getElementById('Z_result').value
                    }
                }
            };
            
            const blob = new Blob([JSON.stringify(results, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = '张祥前统一场论仿真结果.json';
            a.click();
            URL.revokeObjectURL(url);
            console.log('结果已导出');
        }

        // 全屏模式
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        // 更新所有可视化
        function updateAllVisualizations() {
            updateFormula1Visualization();
            updateFormula2Visualization();
            updateFormula3Visualization();
            updateFormula4Visualization();
            updateFormula7Visualization();
            updateFormula19Visualization();
            
            if (simulationRunning) {
                animationFrameId = requestAnimationFrame(updateAllVisualizations);
            }
        }

        // 公式1可视化更新
        function updateFormula1Visualization() {
            const lightSpeed = parseFloat(document.getElementById('lightSpeed1').value);
            const time = parseFloat(document.getElementById('time1').value);
            const angle = parseFloat(document.getElementById('angle1').value) * Math.PI / 180;
            
            const distance = lightSpeed * time;
            const x = distance * Math.cos(angle);
            const y = distance * Math.sin(angle);
            
            const viz = document.getElementById('viz1');
            viz.innerHTML = `
                <div style="position: relative; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                    <div style="font-size: 1.2em; margin-bottom: 10px;">时空运动轨迹</div>
                    <div style="font-size: 1em;">距离: ${distance.toFixed(2)} × 10⁸ m</div>
                    <div style="font-size: 1em;">坐标: (${x.toFixed(2)}, ${y.toFixed(2)})</div>
                    <div style="margin-top: 20px; width: 200px; height: 200px; border: 2px solid #00ffff; border-radius: 50%; position: relative;">
                        <div style="position: absolute; width: 8px; height: 8px; background: #ffff00; border-radius: 50%; 
                                    left: ${100 + x * 10}px; top: ${100 + y * 10}px; transform: translate(-50%, -50%);
                                    box-shadow: 0 0 10px #ffff00;"></div>
                        <div style="position: absolute; width: 2px; height: ${distance * 10}px; background: #00ffff; 
                                    left: 50%; top: 50%; transform-origin: 0 0; 
                                    transform: translate(-50%, -50%) rotate(${angle}rad);"></div>
                    </div>
                </div>
            `;
        }

        // 公式2可视化更新
        function updateFormula2Visualization() {
            const radius = parseFloat(document.getElementById('radius2').value);
            const omega = parseFloat(document.getElementById('omega2').value);
            const pitch = parseFloat(document.getElementById('pitch2').value);
            
            const time = Date.now() * 0.001;
            const x = radius * Math.cos(omega * time);
            const y = radius * Math.sin(omega * time);
            const z = pitch * time;
            
            const viz = document.getElementById('viz2');
            viz.innerHTML = `
                <div style="position: relative; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                    <div style="font-size: 1.2em; margin-bottom: 10px;">三维螺旋轨迹</div>
                    <div style="font-size: 1em;">位置: (${x.toFixed(2)}, ${y.toFixed(2)}, ${z.toFixed(2)})</div>
                    <div style="font-size: 1em;">角速度: ${omega} rad/s, 螺距: ${pitch}</div>
                    <div style="margin-top: 20px; width: 200px; height: 200px; border: 2px solid #00ffff; border-radius: 50%; position: relative; perspective: 1000px;">
                        <div style="position: absolute; width: 8px; height: 8px; background: #ffff00; border-radius: 50%; 
                                    left: ${100 + x * 15}px; top: ${100 + y * 15}px; transform: translate(-50%, -50%);
                                    box-shadow: 0 0 10px #ffff00; z-index: ${Math.floor(z * 10) + 100};"></div>
                        <div style="position: absolute; width: 100%; height: 2px; background: linear-gradient(90deg, transparent, #00ffff, transparent); 
                                    left: 0; top: 50%; transform: rotate(${omega * time}rad);"></div>
                    </div>
                </div>
            `;
        }

        // 公式3可视化更新
        function updateFormula3Visualization() {
            const k = parseFloat(document.getElementById('constant3').value);
            const density = parseFloat(document.getElementById('density3').value);
            const theta = parseFloat(document.getElementById('theta3').value) * Math.PI / 180;
            
            const mass = k * density;
            const solidAngle = 2 * Math.PI * (1 - Math.cos(theta));
            
            const viz = document.getElementById('viz3');
            viz.innerHTML = `
                <div style="position: relative; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                    <div style="font-size: 1.2em; margin-bottom: 10px;">质量场分布</div>
                    <div style="font-size: 1em;">质量: m = ${mass.toFixed(2)} kg</div>
                    <div style="font-size: 1em;">立体角: Ω = ${solidAngle.toFixed(3)} sr</div>
                    <div style="margin-top: 20px; width: 200px; height: 200px; position: relative;">
                        <div style="position: absolute; width: 100%; height: 100%; border: 2px solid #00ff00; border-radius: 50%;"></div>
                        ${Array.from({length: Math.floor(density)}, (_, i) => {
                            const angle = (i / density) * 2 * Math.PI;
                            const r = 80 + Math.random() * 20;
                            return `<div style="position: absolute; width: 4px; height: 4px; background: #00ff00; border-radius: 50%; 
                                           left: ${100 + r * Math.cos(angle)}px; top: ${100 + r * Math.sin(angle)}px; 
                                           transform: translate(-50%, -50%); box-shadow: 0 0 5px #00ff00;"></div>`;
                        }).join('')}
                    </div>
                </div>
            `;
        }

        // 公式4可视化更新
        function updateFormula4Visualization() {
            const G = parseFloat(document.getElementById('gravity4').value) * 1e-11;
            const M = parseFloat(document.getElementById('mass4').value);
            const r = parseFloat(document.getElementById('distance4').value);
            
            const fieldStrength = G * M / (r * r);
            
            const viz = document.getElementById('viz4');
            viz.innerHTML = `
                <div style="position: relative; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                    <div style="font-size: 1.2em; margin-bottom: 10px;">引力场分布</div>
                    <div style="font-size: 1em;">场强: ${fieldStrength.toExponential(2)} N/kg</div>
                    <div style="font-size: 1em;">质量: ${M} kg, 距离: ${r} m</div>
                    <div style="margin-top: 20px; width: 200px; height: 200px; position: relative;">
                        <div style="position: absolute; width: 20px; height: 20px; background: #ff0000; border-radius: 50%; 
                                    left: 50%; top: 50%; transform: translate(-50%, -50%); box-shadow: 0 0 20px #ff0000;"></div>
                        ${Array.from({length: 12}, (_, i) => {
                            const angle = (i / 12) * 2 * Math.PI;
                            return `<div style="position: absolute; width: 2px; height: 60px; background: linear-gradient(to bottom, #ff4444, transparent); 
                                           left: 50%; top: 50%; transform-origin: 50% 0%; 
                                           transform: translate(-50%, -50%) rotate(${angle}rad);"></div>`;
                        }).join('')}
                    </div>
                </div>
            `;
        }

        // 公式7可视化更新
        function updateFormula7Visualization() {
            const dmdt = parseFloat(document.getElementById('dmdt7').value);
            const V = parseFloat(document.getElementById('velocity7').value);
            const dcdt = parseFloat(document.getElementById('dcdt7').value);
            
            const C = 3e8; // 光速
            const m = 1; // 假设质量为1kg
            
            const F_electric = C * dmdt;
            const F_magnetic = -V * dmdt;
            const F_nuclear = m * dcdt;
            const F_gravity = -m * 0; // 假设dV/dt = 0
            
            const viz = document.getElementById('viz7');
            viz.innerHTML = `
                <div style="position: relative; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                    <div style="font-size: 1.2em; margin-bottom: 10px;">四种基本力统一</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.9em;">
                        <div style="color: #ff0000;">电场力: ${F_electric.toExponential(2)} N</div>
                        <div style="color: #00ff00;">磁场力: ${F_magnetic.toExponential(2)} N</div>
                        <div style="color: #0000ff;">核力: ${F_nuclear.toFixed(2)} N</div>
                        <div style="color: #ffff00;">引力: ${F_gravity.toFixed(2)} N</div>
                    </div>
                    <div style="margin-top: 20px; width: 200px; height: 200px; position: relative;">
                        <div style="position: absolute; width: 10px; height: 10px; background: #ffffff; border-radius: 50%; 
                                    left: 50%; top: 50%; transform: translate(-50%, -50%);"></div>
                        <div style="position: absolute; width: 3px; height: ${Math.abs(F_electric) * 1e-7 + 20}px; background: #ff0000; 
                                    left: 50%; top: 50%; transform: translate(-50%, -100%);"></div>
                        <div style="position: absolute; width: ${Math.abs(F_magnetic) * 10 + 20}px; height: 3px; background: #00ff00; 
                                    left: 50%; top: 50%; transform: translate(0%, -50%);"></div>
                        <div style="position: absolute; width: 3px; height: ${Math.abs(F_nuclear) + 20}px; background: #0000ff; 
                                    left: 50%; top: 50%; transform: translate(-50%, 0%);"></div>
                        <div style="position: absolute; width: ${Math.abs(F_gravity) + 20}px; height: 3px; background: #ffff00; 
                                    left: 50%; top: 50%; transform: translate(-100%, -50%);"></div>
                    </div>
                </div>
            `;
        }

        // 公式19可视化更新
        function updateFormula19Visualization() {
            const G = parseFloat(document.getElementById('G_precise').value) * 1e-11;
            const c = parseFloat(document.getElementById('c_precise').value);
            const Z = (G * c) / 2;
            
            document.getElementById('Z_result').value = Z.toExponential(6);
            
            const viz = document.getElementById('viz19');
            viz.innerHTML = `
                <div style="position: relative; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                    <div style="font-size: 1.2em; margin-bottom: 10px;">宇宙统一常数</div>
                    <div style="font-size: 1.1em; color: #00ffff;">Z = ${Z.toExponential(6)}</div>
                    <div style="font-size: 0.9em; margin-top: 10px;">
                        G = ${G.toExponential(3)} m³kg⁻¹s⁻²<br>
                        c = ${c.toExponential(3)} m/s
                    </div>
                    <div style="margin-top: 20px; width: 200px; height: 200px; position: relative;">
                        <div style="position: absolute; width: 100%; height: 100%; border: 3px solid #ffffff; border-radius: 50%; 
                                    animation: pulse 2s ease-in-out infinite;"></div>
                        <div style="position: absolute; width: 80%; height: 80%; border: 2px solid #00ffff; border-radius: 50%; 
                                    left: 10%; top: 10%; animation: pulse 2s ease-in-out infinite reverse;"></div>
                        <div style="position: absolute; width: 60%; height: 60%; border: 2px solid #ff00ff; border-radius: 50%; 
                                    left: 20%; top: 20%; animation: pulse 2s ease-in-out infinite;"></div>
                        <div style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); 
                                    font-size: 1.2em; font-weight: bold; color: #ffff00;">Z</div>
                    </div>
                </div>
                <style>
                    @keyframes pulse {
                        0%, 100% { transform: scale(1); opacity: 1; }
                        50% { transform: scale(1.1); opacity: 0.7; }
                    }
                </style>
            `;
        }

        // 添加参数变化监听器
        document.addEventListener('DOMContentLoaded', function() {
            // 为所有滑块添加事件监听器
            const sliders = document.querySelectorAll('input[type="range"]');
            sliders.forEach(slider => {
                slider.addEventListener('input', updateAllVisualizations);
            });
            
            // 初始化显示
            updateAllVisualizations();
            
            // 自动启动仿真
            setTimeout(startSimulation, 1000);
        });

        // MathJax渲染完成后的回调
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            startup: {
                ready: () => {
                    MathJax.startup.defaultReady();
                    console.log('MathJax渲染完成');
                }
            }
        };
    </script>
</body>
</html>